<html>
<head>
<title>updater</title>
</head>
<body>
<div id="version"></div>
<script>
  var pkg = require('./package.json');
  var request = require('request');
  var k = 0;
  setInterval(function(){
    getVersion(function(ver){
      var stat = 'not changed';
      if(ver !== pkg.version){
        stat = 'changed';
      }
      document.getElementById('version').innerHTML = k++ +":"+ ver + ":" + stat + ">" + pkg.version;
    })
  }, 500);

  function getVersion(cb){
    request.get('https://raw.githubusercontent.com/openconf/updater/master/package.json', gotPkgJson);
    function gotPkgJson(err, req, data){
      if(err) {
        console.error(err);
        return;
      }
      cb(JSON.parse(data).version);
    }
  }
</script>
</body>
</html>
